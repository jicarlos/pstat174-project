---
title: "PSTAT174-Project"
author: "Jon Carlos (3872520)"
date: "2023-03-13"
output: pdf_document
indent: true
header-includes:
  - \usepackage{setspace}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=FALSE, warning=FALSE}
library(tidyverse)
library(ggplot2)
library(ggfortify)
library(ggthemes)
library(zoo)
library(forecast)
library(Mcomp)
library(MASS)
library(fabletools)
library(reshape2)
```


\doublespace



```{r}
EU_Max_Temperatures <- read.csv("Temperatures_In_Europe.csv")
names(EU_Max_Temperatures) <- c("date", "Berlin", "Paris", "Copenhagen", "Stockholm", "Rome")

head(EU_Max_Temperatures, 5)
summary(EU_Max_Temperatures)
```

However, there is some missing data within the column for Rome as seen above so we must remove them. Because the data set is rather large to begin with starting all the way from the year 1900, we can get rid of data from each other column until Rome finally has some. Looking at the data set, Rome begins to have some data when ```date = 1944-06```, but is still patchy with this information until around ```1951-01```. Therefore, all data from before this will be removed and only from 1951 and onward will be analyzed.

```{r}
EU_Max_Temperatures <- EU_Max_Temperatures[EU_Max_Temperatures$date >= '1951-01',]
head(EU_Max_Temperatures, 5)

```

```{r}
Temperatures_TS <- ts(EU_Max_Temperatures[,c(2:6)], start = c(1951), frequency = 12)

autoplot(Temperatures_TS)
autoplot(Temperatures_TS, facets = TRUE)
```

```{r}
Temperatures_TS_Berlin <- diff(Temperatures_TS[,1])
Temperatures_TS_Paris <- diff(Temperatures_TS[,2])
Temperatures_TS_Copenhagen <- diff(Temperatures_TS[,3])
Temperatures_TS_stockholm <- diff(Temperatures_TS[,4])
Temperatures_TS_Rome <- diff(Temperatures_TS[,5])

plot(diff(Temperatures_TS[,1], differences = 1))
plot(diff(Temperatures_TS[,1], differences = 2))
```

```{r}
boxcox(lm(Temperatures_TS[,1] ~ 1))
```

When rounding to the closest $lambda$ value, $lambda = 1$. Therefore, we do not need to make any BoxCox transformations to the data.

```{r}
par(mfcol = c(2,2))

acf(Temperatures_TS[,1])
pacf(Temperatures_TS[,1])

acf(Temperatures_TS_Berlin)
pacf(Temperatures_TS_Berlin)
```

```{r}
Decomp_Temperatures_TS_Berlin <- decompose(Temperatures_TS[,1])
Decomp_Temperatures_TS_Paris <- decompose(Temperatures_TS[,2])
Decomp_Temperatures_TS_Copenhagen <- decompose(Temperatures_TS[,3])
Decomp_Temperatures_TS_Stockholm <- decompose(Temperatures_TS[,4])
Decomp_Temperatures_TS_Rome <- decompose(Temperatures_TS[,5])

autoplot(Decomp_Temperatures_TS_Berlin)
autoplot(Decomp_Temperatures_TS_Paris)
autoplot(Decomp_Temperatures_TS_Copenhagen)
autoplot(Decomp_Temperatures_TS_Stockholm)
autoplot(Decomp_Temperatures_TS_Rome)
```

```{r}
Box.test(Temperatures_TS[,1], type = c("Box-Pierce"), fitdf = 0)
Box.test(Temperatures_TS[,1], type = c("Ljung-Box"), fitdf = 0)
```

```{r}
Temperatures_TS[,1] <- Temperatures_TS[,1] - Decomp_Temperatures_TS_Berlin$seasonal


plot(Temperatures_TS[,1])
lines(Decomp_Temperatures_TS_Berlin$trend, col = "red")
fit.auto <- auto.arima(Temperatures_TS[,1], max.order = 2, trace = TRUE)
```

